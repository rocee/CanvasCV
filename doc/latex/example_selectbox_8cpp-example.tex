\hypertarget{example_selectbox_8cpp-example}{}\section{example\+\_\+selectbox.\+cpp}
This is an example of how to use the Selection\+Box Widget.


\begin{DoxyCodeInclude}
\textcolor{preprocessor}{#include "canvascv/canvas.h"}

\textcolor{comment}{// These are used to create widgets}
\textcolor{preprocessor}{#include "canvascv/widgets/selectionbox.h"}

\textcolor{preprocessor}{#include <iostream>}
\textcolor{preprocessor}{#include <iterator>}

\textcolor{preprocessor}{#include <opencv2/highgui.hpp>}

\textcolor{keyword}{using namespace }\hyperlink{namespacestd}{std};
\textcolor{keyword}{using namespace }\hyperlink{namespacecv}{cv};
\textcolor{keyword}{using namespace }\hyperlink{namespacecanvascv}{canvascv};

shared\_ptr<SelectionBox> selectionBox;

\textcolor{comment}{// This is needed for user interaction - creating/editing choosing shapes.}
\textcolor{comment}{// Clicking on interactive widgets.}
\textcolor{comment}{// We don't need this code if we only want to display "on screen" messages and "status bar" messages.}
\textcolor{comment}{// see also Canvas::setMouseCallback()}
\textcolor{keyword}{static} \textcolor{keywordtype}{void} mouseCB(\textcolor{keywordtype}{int} event, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} flags, \textcolor{keywordtype}{void}* userData) \{
    (void)flags;
    \hyperlink{classcanvascv_1_1Canvas}{Canvas} *pCanvas=\textcolor{keyword}{reinterpret\_cast<}\hyperlink{classcanvascv_1_1Canvas}{Canvas}*\textcolor{keyword}{>}(userData);
    Point pos(x,y);
    \textcolor{keywordflow}{switch}( event )
    \{
    \textcolor{keywordflow}{case} EVENT\_LBUTTONDOWN:
        \textcolor{keywordflow}{if} (selectionBox->getVisible() == \textcolor{keyword}{false})
        \{
            selectionBox->setLocation(pos);
            selectionBox->setVisible(\textcolor{keyword}{true});
        \}
        \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (! pCanvas->\hyperlink{classcanvascv_1_1Canvas_abe53228080133efe5d9fecf6982b823e}{onMousePress}(pos))
        \{
            selectionBox->setLocation(pos);
        \}
        \textcolor{keywordflow}{break};
    \textcolor{keywordflow}{case} EVENT\_LBUTTONUP:
        pCanvas->\hyperlink{classcanvascv_1_1Canvas_aca936fe492da286d5fb8eabbcd061793}{onMouseRelease}(pos);
        \textcolor{keywordflow}{break};
    \textcolor{keywordflow}{case} EVENT\_MOUSEMOVE:
        pCanvas->\hyperlink{classcanvascv_1_1Canvas_a1189823898c4022fd0eed4cfb99535c2}{onMouseMove}(pos);
        \textcolor{keywordflow}{break};
    \}
\}

\textcolor{keywordtype}{int} main(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char} **argv)
\{
    --argc;
    ++argv;
    Mat image;
    \textcolor{keywordflow}{if} (argc)
    \{
        Mat orig = imread(argv[0]);
        \textcolor{keywordflow}{if} (orig.empty())
        \{
            \hyperlink{classcanvascv_1_1Canvas_add93c0d5cc1e9b49f97510952a8a1961}{Canvas::fatal}(\textcolor{keywordtype}{string}(\textcolor{stringliteral}{"Cannot load image "}) + argv[0], -1);
        \}
        \textcolor{keywordflow}{if} (orig.cols > 1024)
        \{
            \textcolor{keywordtype}{double} ratio = 1024. / orig.cols;
            cv::resize(orig, image, Size(), ratio, ratio);
        \}
        \textcolor{keywordflow}{else}
        \{
            image = orig;
        \}
    \}
    \textcolor{keywordflow}{else}
    \{
        \hyperlink{classcanvascv_1_1Canvas_add93c0d5cc1e9b49f97510952a8a1961}{Canvas::fatal}(\textcolor{stringliteral}{"Must get a path to an image as a parameter"} , -1);
    \}

    \hyperlink{classcanvascv_1_1Canvas}{Canvas} c(\textcolor{stringliteral}{"Canvas"}, image.size());
    selectionBox = \hyperlink{classcanvascv_1_1SelectionBox_af1f8e0c480d006706bc5240cd1ebd075}{SelectionBox::create}(c, \{
                                            \textcolor{stringliteral}{"Long Option1"},     \textcolor{comment}{// index 0}
                                            \textcolor{stringliteral}{"Option2\(\backslash\)n2 lines"}, \textcolor{comment}{// index 1}
                                            \textcolor{stringliteral}{"Option3"}           \textcolor{comment}{// index 2}
                                        \}, [&c](\hyperlink{classcanvascv_1_1Widget}{Widget} *w, \textcolor{keywordtype}{int} i) \{
            w->\hyperlink{classcanvascv_1_1Widget_a3c9bd8b6b90dbe3958e452e04843feb1}{setVisible}(\textcolor{keyword}{false});
            cout << \textcolor{stringliteral}{"Option "} << i << \textcolor{stringliteral}{" was chosen"} << endl;
            \hyperlink{classcanvascv_1_1SelectionBox}{SelectionBox} *sb = (\hyperlink{classcanvascv_1_1SelectionBox}{SelectionBox}*)w;
            c.setScreenText(CCV\_STR(\textcolor{stringliteral}{"User selected option '"} << i<< \textcolor{stringliteral}{"': '"} << sb->
      \hyperlink{classcanvascv_1_1SelectionBox_adb7793b6a0508af80e6320f87549a99e}{getTextAt}(i) << \textcolor{stringliteral}{"'\(\backslash\)n"} <<
                                    \textcolor{stringliteral}{"left click to open selection box. left click to select an item\(\backslash\)n'q' to
       quit"}));
\});
    selectionBox->setVisible(\textcolor{keyword}{false});

    namedWindow(\textcolor{stringliteral}{"Canvas"}, WINDOW\_AUTOSIZE);
    setMouseCallback(\textcolor{stringliteral}{"Canvas"}, mouseCB, &c);

    c.enableScreenText();
    c.setScreenText(\textcolor{stringliteral}{"left click to open selection box. left click to select an item\(\backslash\)n'q' to quit"});

    \textcolor{keywordtype}{int} key = 0;
    Mat out; \textcolor{comment}{// keeping it out of the loop is a little more efficient}
    \textcolor{keywordflow}{while} (key != \textcolor{charliteral}{'q'})
    \{
        c.redrawOn(image, out);
        imshow(\textcolor{stringliteral}{"Canvas"}, out);
        key = c.waitKeyEx(); \textcolor{comment}{// GUI and callbacks happen here}
    \}

    destroyAllWindows();
    \textcolor{keywordflow}{return} 0;
\}
\end{DoxyCodeInclude}
 