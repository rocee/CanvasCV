---
layout: reference
sitemap: false
---
<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtmlcharset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CanvasCV: Leaving the console</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px">
  <td id="projectalign" style="padding-left: 0.5em">
   <div id="projectname">CanvasCV
   &#160<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Leaving the console </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#screentext_s1">Introducing the CanvasCV class</a></li>
<li class="level1"><a href="#screentext_s2">Some real use cases</a><ul><li class="level2"><a href="#screentext_s2_1">Exiting on fatal errors</a></li>
<li class="level2"><a href="#screentext_s2_2">Displaying user text in a fixed location</a></li>
<li class="level2"><a href="#screentext_s2_3">Displaying text where ever you want</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>OpenCV examples and tutorials make heavy use of the console to commuincate with the user.</p>
<p>To start using the GUI instead of the console the first thing you need is to get to know the <a class="el" href="classcanvascv_1_1Canvas.html" title="The Canvas class is the entry point into CanvasCV. ">canvascv::Canvas</a> class.</p>
<h1><a class="anchor" id="screentext_s1"></a>
Introducing the CanvasCV class</h1>
<p>The Canvas class is associated with an OpenCV window and it gives you another virtual layer on top of your displayed Mat.</p>
<p>This canvas class encapsulates <b>a lot</b> of work for you, so you can focus on the CV. It also handles key presses and mouse events.</p>
<p>The basic flow is:</p><ul>
<li>Define a Canvas for a window of a specific size, usually to match the image you're displayng. <div class="fragment"><div class="line">Canvas c(<span class="stringliteral">&quot;winName&quot;</span>, frame.size());</div></div><!-- fragment --></li>
<li>Create an OpenCV window without resizing so the widgets cannot be stretched <div class="fragment"><div class="line">namedWindow(<span class="stringliteral">&quot;winName&quot;</span>, WINDOW_AUTOSIZE); <span class="comment">// disable mouse resize</span></div></div><!-- fragment --></li>
<li>Let the CanvasCV handle your mouse events <div class="fragment"><div class="line">c.<a class="code" href="classcanvascv_1_1Canvas.html#acf6e5d4b40aec610b0dc8c4f6bf93ac1">setMouseCallback</a>(); <span class="comment">// optional for mouse usage (see also example_selectbox.cpp)</span></div></div><!-- fragment --></li>
<li>Create your widget on the Canvas (or in a frame/layout) for example: <div class="fragment"><div class="line"><span class="keyword">auto</span> msgBox = MsgBox::create(c, <span class="stringliteral">&quot;Do you really want to do that?&quot;</span>, {<span class="stringliteral">&quot;Yes&quot;</span>, <span class="stringliteral">&quot;No&quot;</span>});</div></div><!-- fragment --></li>
<li>Redraw on your frame/image in your regular OpenCV loop, as in: <div class="fragment"><div class="line"><span class="keywordtype">int</span> delay = 1000/25; <span class="comment">// for a single image, delay should be 0</span></div><div class="line"><span class="keywordtype">int</span> key = -1;</div><div class="line">Mat out;</div><div class="line"><span class="keywordflow">while</span> (<span class="keyword">true</span>)</div><div class="line">{</div><div class="line">    c.<a class="code" href="classcanvascv_1_1Canvas.html#a018c66e277de7904b8146ea3f3feebdd">redrawOn</a>(frame, out);   <span class="comment">// draws your virtual GUI layer on top of the &#39;frame&#39;</span></div><div class="line">    c.<a class="code" href="classcanvascv_1_1Canvas.html#acaf9494a5668046dd0a8908aa97a7a43">imshow</a>(out);            <span class="comment">// you can also use imshow directly for &quot;winName&quot;</span></div><div class="line">    key = c.<a class="code" href="classcanvascv_1_1Canvas.html#a59397db05f5d9e45264f626f6a2ae528">waitKeyEx</a>(delay); <span class="comment">// forwards key presses to widgets and shapes</span></div><div class="line">}</div></div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="screentext_s2"></a>
Some real use cases</h1>
<h2><a class="anchor" id="screentext_s2_1"></a>
Exiting on fatal errors</h2>
<p>Your application/utility might need command line arguments, or cannot continue for some reason.</p>
<p>A simple write to the console before exiting is usually not enough to get the user attention.</p>
<p>For these simple cases you have a simple shortcut in <a class="el" href="classcanvascv_1_1Canvas.html#add93c0d5cc1e9b49f97510952a8a1961" title="fatal ">canvascv::Canvas::fatal()</a>: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;canvascv/canvas.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacecanvascv.html">canvascv</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">    --argc;</div><div class="line">    ++argv;</div><div class="line">    <span class="keywordflow">if</span> (! argc)</div><div class="line">    {</div><div class="line">        <a class="code" href="classcanvascv_1_1Canvas.html#add93c0d5cc1e9b49f97510952a8a1961">Canvas::fatal</a>(<span class="stringliteral">&quot;Must get a path to an image as a parameter&quot;</span> , -1);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p>which, besides an output to STDERR, gives you: </p><div class="image">
<img src="tut_fatal.jpg" alt="tut_fatal.jpg"/>
</div>
<p> <br />
</p>
<h2><a class="anchor" id="screentext_s2_2"></a>
Displaying user text in a fixed location</h2>
<p>Instead of displaying the help message or any other fixed text to the console use the <a class="el" href="classcanvascv_1_1Canvas.html#ae68d3277e738d349232400b38f0e5f9e" title="enableScreenText enables the top left text area for manual user messages ">canvascv::Canvas::enableScreenText()</a> and canvaccv::Canvas::setScreenText(string) methods.</p>
<p>This flow is a little closer to the regular usage of the <em>Canvas</em>, but you don't need to create a widget of your own.</p>
<p>Adding to the previous example (we want to display this on an image): </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;canvascv/canvas.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacecanvascv.html">canvascv</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> help(<a class="code" href="classcanvascv_1_1Canvas.html">Canvas</a> &amp;c)</div><div class="line">{</div><div class="line">    <span class="keyword">static</span> <span class="keywordtype">bool</span> showHelp = <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">static</span> <span class="keywordtype">string</span> helpMsg =</div><div class="line">            <span class="stringliteral">&quot;Usage:\n&quot;</span></div><div class="line">            <span class="stringliteral">&quot;=====\n&quot;</span></div><div class="line">            <span class="stringliteral">&quot;h: toggle usage message\n&quot;</span></div><div class="line">            <span class="stringliteral">&quot;*: toggle canvas on/off\n&quot;</span></div><div class="line">            <span class="stringliteral">&quot;q: exit&quot;</span>;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (showHelp) c.<a class="code" href="classcanvascv_1_1Canvas.html#aaedea276b82a8a4cfc0895ae81113cfd">setScreenText</a>(helpMsg);</div><div class="line">    <span class="keywordflow">else</span> c.<a class="code" href="classcanvascv_1_1Canvas.html#aaedea276b82a8a4cfc0895ae81113cfd">setScreenText</a>(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"></div><div class="line">    showHelp = ! showHelp;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div><div class="line">{</div><div class="line">    --argc;</div><div class="line">    ++argv;</div><div class="line">    <span class="keywordflow">if</span> (! argc)</div><div class="line">    {</div><div class="line">        <a class="code" href="classcanvascv_1_1Canvas.html#add93c0d5cc1e9b49f97510952a8a1961">Canvas::fatal</a>(<span class="stringliteral">&quot;Must get a path to an image as a parameter&quot;</span> , -1);</div><div class="line">    }</div><div class="line"></div><div class="line">    Mat image = imread(argv[0]);</div><div class="line">    <span class="keywordflow">if</span> (image.empty())</div><div class="line">    {</div><div class="line">        <a class="code" href="classcanvascv_1_1Canvas.html#add93c0d5cc1e9b49f97510952a8a1961">Canvas::fatal</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;Cannot load image &quot;</span>) + argv[0], -2);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="classcanvascv_1_1Canvas.html">Canvas</a> c(<span class="stringliteral">&quot;Canvas&quot;</span>, image.size());</div><div class="line">    c.<a class="code" href="classcanvascv_1_1Canvas.html#ae68d3277e738d349232400b38f0e5f9e">enableScreenText</a>(); <span class="comment">// see it&#39;s documentation</span></div><div class="line"></div><div class="line">    help(c);</div><div class="line"></div><div class="line">    namedWindow(<span class="stringliteral">&quot;Canvas&quot;</span>, WINDOW_AUTOSIZE); <span class="comment">// disable mouse resize</span></div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> key = 0;</div><div class="line">    Mat out;</div><div class="line">    <span class="keywordflow">do</span></div><div class="line">    {</div><div class="line">        <span class="keywordflow">switch</span> (key)</div><div class="line">        {</div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div><div class="line">            help(c);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;*&#39;</span>:</div><div class="line">            c.<a class="code" href="classcanvascv_1_1Canvas.html#aba149ea25c6cdad2673133a060355954">setOn</a>(! c.<a class="code" href="classcanvascv_1_1Canvas.html#afe6a2955a5bbee8903350b4fba3f4473">getOn</a>());</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        c.<a class="code" href="classcanvascv_1_1Canvas.html#a018c66e277de7904b8146ea3f3feebdd">redrawOn</a>(image, out);   <span class="comment">// draw the canvas on the image copy</span></div><div class="line"></div><div class="line">        imshow(<span class="stringliteral">&quot;Canvas&quot;</span>, out);    <span class="comment">// using cv::imshow works fine</span></div><div class="line"></div><div class="line">        key = c.<a class="code" href="classcanvascv_1_1Canvas.html#a59397db05f5d9e45264f626f6a2ae528">waitKeyEx</a>(); <span class="comment">// GUI and callbacks happen here</span></div><div class="line"></div><div class="line">    } <span class="keywordflow">while</span> (key != <span class="charliteral">&#39;q&#39;</span>);</div><div class="line"></div><div class="line">    destroyAllWindows();</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p>Some notes here:</p><ul>
<li>Note the continued use of <a class="el" href="classcanvascv_1_1Canvas.html#add93c0d5cc1e9b49f97510952a8a1961" title="fatal ">canvascv::Canvas::fatal()</a>.</li>
<li>Note that we didn't need to use <a class="el" href="classcanvascv_1_1Canvas.html#acf6e5d4b40aec610b0dc8c4f6bf93ac1" title="utility method to handle mouse events on the associated window ">canvascv::Canvas::setMouseCallback()</a> or create a widget of our own here.</li>
<li>When you <a class="el" href="classcanvascv_1_1Canvas.html#ae68d3277e738d349232400b38f0e5f9e" title="enableScreenText enables the top left text area for manual user messages ">canvascv::Canvas::enableScreenText()</a> you can configure it's display.</li>
<li>As you can see the <em>Canvas</em> instance can be completely turned on and off with the <a class="el" href="classcanvascv_1_1Canvas.html#aba149ea25c6cdad2673133a060355954" title="redrawOn will do nothing if value is &#39;false&#39; ">canvascv::Canvas::setOn()</a> method.</li>
<li><a class="el" href="classcanvascv_1_1Canvas.html#a59397db05f5d9e45264f626f6a2ae528" title="waitKeyEx ">canvascv::Canvas::waitKeyEx()</a> knows to update it's internal shapes and widgets even if you pass 0 as a blocking delay indicator.</li>
<li>When executed with a path to an image, this gives you (depends on your image): <div class="image">
<img src="tut_screentext.jpg" alt="tut_screentext.jpg"/>
</div>
 <br />
</li>
</ul>
<h2><a class="anchor" id="screentext_s2_3"></a>
Displaying text where ever you want</h2>
<p>To display text where you want you need the <a class="el" href="classcanvascv_1_1Text.html" title="The Text class. ">canvascv::Text</a> widget.</p>
<p>You can create position it on the Canvas at any XY location.</p>
<p>Add these lines to the previous example, after creating the namedWindow(): </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacecanvascv.html">canvascv</a>;</div><div class="line">    <span class="comment">//...</span></div><div class="line"></div><div class="line">    <span class="keyword">auto</span> txt = <a class="code" href="classcanvascv_1_1Text.html#a7f3552263b6f185f78d90549e7ac38f7">Text::create</a>(c, <span class="stringliteral">&quot;Target Acquired!&quot;</span>);</div><div class="line">    txt-&gt;setFontHeight(50);</div><div class="line">    txt-&gt;setOutlineColor(<a class="code" href="classcanvascv_1_1Colors.html#a10aff24c53edf45b038d0636b061f9c2">Colors::Red</a>);</div><div class="line">    txt-&gt;setThickness(2);</div><div class="line">    txt-&gt;setLocation({30, image.rows / 2 - 15});</div><div class="line"></div><div class="line">    <span class="comment">//...</span></div></div><!-- fragment --><p>Notes:</p><ul>
<li>All widgets have a static create methods, which is the only way to create them.</li>
<li>The <a class="el" href="classcanvascv_1_1Text.html#a7f3552263b6f185f78d90549e7ac38f7" title="create a Text widget ">canvascv::Text::create()</a> will return a shared_ptr&lt;Text&gt; instance, which you don't have to keep since another one is kept by the <a class="el" href="classcanvascv_1_1Layout.html" title="The Layout class. ">canvascv::Layout</a>.</li>
<li>There are many Colors constants to choose from, see <a class="el" href="classcanvascv_1_1Colors.html" title="The Colors class. ">canvascv::Colors</a>.</li>
<li>The <a class="el" href="classcanvascv_1_1Widget.html#a8a36b15a1c777baffbb4fcd4ccda3c45" title="set widget position in Canvas ">canvascv::Widget::setLocation()</a> gives specific XY postion, but a <a class="el" href="classcanvascv_1_1HorizontalLayout.html" title="The HorizontalLayout class. ">canvascv::HorizontalLayout</a> could help us put this in the <em>CENTER</em>.</li>
<li>When executed with a path to an image, this gives you (depends on your image): <div class="image">
<img src="tut_text.jpg" alt="tut_text.jpg"/>
</div>
 <br />
</li>
</ul>
<p><b>That's all for this tutorial</b> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
